---
title: "Introduction to the Tidyverse"
author: "Author"
date: "Date"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(fig.retina = 3, message = FALSE) #rendering sharp plots / not showing messages
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_mono_light(base_color = "#23395b")
library(tidyverse)
library(knitr)
```

# Today's outline

--

- What you have learnt so far

--

- Taking it a step further – introducing the Tidyverse

--

- Data wrangling with `dplyr`

--

- Data visualisation with `ggplot2`

--

- Final exercise

--

- Feedback & concluding remarks

---

# R and R Studio

"It is important to note the differences between R and RStudio. *R is a programming language* used for statistical computing while RStudio uses the R language to develop statistical programs. In R, you can write a program and run the code independently of any other computer program. *RStudio however, must be used alongside R in order to properly function*. Often referred to as an IDE, or *integrated development environment*, RStudio allows users to develop and edit programs in R by supporting a large number of statistical packages, higher quality graphics, and the ability to manage your workspace.

*R and RStudio are not separate versions of the same program*, and cannot be substituted for one another. R may be used without RStudio, but RStudio may not be used without R ([Source](https://wp.stolaf.edu/it/r-vs-rstudio/))."

---

# What you have learnt so far

--

-	Familiarity with the RStudio interface

--

-	Working with scripts

--

-	Simple data structures 

--

-	First data wrangling and visualisations

---

# Tidy data – a philosophy of data 

--

-	[Wickham (2014)](https://vita.had.co.nz/papers/tidy-data.pdf) aimed to standardise the data preparation process 

--

.center[
<h4>
«Each variable is a column, each observation is a row, and each type of observational unit is a table.»
</h4>
]

--

```{r}
head(table1, n = 4) %>% 
  kable(format = "html")
```

---

# Another example

```{r, echo=F}
library(palmerpenguins)
data(package = "palmerpenguins")
```

```{r}
head(penguins, n = 5) %>% 
  select(1:5) %>% 
  kable(format = "html")
```

---

## From tidy data to the tidyverse

--

-	The tidyverse is an opinionated collection of R packages designed to facilitate data science

--

- Its tools (read: packages) use/generate tidy data both as input/output

--

-	`dplyr`: Helps to transform messy data to tidy data

--

-	`ggplot2`: Uses tidy data to create graphics

---

# The whole workflow

![The Tidyverse Workflow](tidyverse_workflow.png)

Source: [Teach Data Science](https://teachdatascience.com/tidyverse/)

---

class: center, middle

<h3>
Questions?
</h3>

---

### How does Base R relate to the Tidyverse?

--

- Yesterday you learnt Base R commands, today Tidyverse commands

--

- Two different approaches to achieving the same goal

--

- <b> Treat them as friends! </b>

--

- A few examples

---

### Extract variables (columns)

#### Base R

```{r, results='hide'}
penguins[, c("island", "year")] # by name
penguins[, c(2, 8)]  # by column index
```

#### Tidyverse

```{r, results='hide'}
select(penguins, island, year) # by name
select(penguins, 2, 8)  # by column index
```

---

### Extract observations (rows)

#### Base R

```{r, results='hide'}
# Using [,]
penguins[penguins$body_mass_g > 3500 & penguins$island == "Torgersen",]
```

#### Tidyverse

```{r, results='hide'}
filter(penguins, body_mass_g > 3500 & island == "Torgersen")
```

---

### Filter rows with conditions evaluated within groups

In words: Penguin with maximum “bill_length_mm” for each “species”.

#### Base R

```{r, results='hide'}
# First operate in the data.frame by group (split-apply)
largest_bills <- by(penguins, 
                    INDICES = penguins$species, 
                    FUN = function(x){
                      x[x$bill_length_mm == max(x$bill_length_mm, 
                                                na.rm = T), ] 
                    })

# Then combine the results into a data.frame
do.call(rbind, largest_bills)
```

#### Tidyverse

```{r, results='hide'}
penguins %>% 
  group_by(species) %>% 
  filter(bill_length_mm == max(bill_length_mm, na.rm = TRUE))
```

---

--

class: center, middle

<h3>
Questions?
</h3>

---

### Introducing the pipe

--

- The pipe operator: `%>%`

--

-  Takes one return value and feeds it in as an input to another function

--

- Think of it as: "and then"

--

- Helps you to write code that is easier to read and understand

--

```{r, results='hide'}
penguins %>% 
  select(species, island, sex, bill_length_mm, year) #<<
```

--

```{r, results='hide'}
penguins %>% 
  select(species, island, sex, bill_length_mm, year) %>% 
  filter(year == 2007) #<<
```

--

```{r, results='hide'}
penguins %>% 
  select(species, island, sex, bill_length_mm, year) %>%
  filter(year == 2007) %>% 
  group_by(island) #<<
```

---

```{r}
penguins %>% 
  select(species, island, bill_length_mm, year) %>%
  filter(year == 2007) %>%
  group_by(island) %>% 
  summarise(bill_length = mean(bill_length_mm, na.rm = TRUE)) #<<
```

--

#### Base R equivalent

```{r}
penguins <- penguins[,c("species", "island", "bill_length_mm", "year")]

penguins <- penguins[penguins$year == 2007, ]

penguins <- penguins[!(is.na(penguins$bill_length_mm)),]

tapply(penguins$bill_length_mm, penguins$island, mean)
```

---

class: center, middle

<h3>
Questions?
</h3>

---

## Recap & outlook

--

- Introduced to the tidy philosophy

--

-	Tools of the Tidyverse

--

- Comparison of Base R and Tidyverse

--

- Next up: Data wrangling with `dplyr`

---

class: center, middle

<h3>
Time to exercise!
</h3>

```{r, include=FALSE}
pagedown::chrome_print("introduction_tidyverse.html")
```
